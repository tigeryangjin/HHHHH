--1.ods_order
INSERT INTO ODSHAPPIGO.ODS_ORDER
  SELECT A.CRM_OBJ_ID,
         A.CRM_NUMINT,
         A.zeamc008,
         A.CRM_OHGUID,
         A.CRM_ITMGUI,
         A.CRM_PRCTYP,
         A.zcrmd023,
         A.CRM_ITMTYP,
         A.ztcmc002,
         A.ztcmc006,
         A.SALESORG,
         A.DISTR_CHAN,
         A.SALES_OFF,
         A.DIVISION,
         A.zmaterial,
         A.zeamc027,
         A.zlifnr,
         A.CRM_ENDCST,
         A.ztcmc016,
         A.AGE,
         A.ztcmc020,
         A.CRM_SOLDTO,
         A.zkunnr_l1,
         A.zkunnr_l2,
         A.zthrc015,
         A.BP_EMPLO,
         A.zthrc016,
         A.zthrc017,
         A.zesdc113,
         A.crmpostdat,
         A.zpst_tim,
         A.zgz_time,
         A.zcrmd001,
         A.CRM_USSTAT,
         A.CRM_STSMA,
         A.CRM_CTD_BY,
         A.CRM_CRD_AT,
         A.CREA_TIME,
         A.zeamc001,
         A.zeamc010,
         A.zeamc011,
         A.zeamc012,
         A.zeamc037,
         A.zeamc013,
         A.zeamc014,
         A.ztcmc021,
         A.ztcmc022,
         A.ztcmc027,
         A.ztcmc026,
         A.ztcmc030,
         A.ztcmc007,
         A.ztcmc008,
         A.ztcmc009,
         A.ztcmc023,
         A.ztcmc024,
         A.ztcmc025,
         A.zcrmd015,
         A.zcrmd016,
         A.zcrmd017,
         A.zcrmd018,
         A.zcr_on,
         A.zobj_cc,
         A.zdsxd,
         A.zjsjf_yn,
         A.zcrmd025,
         A.zcrmd020,
         A.zcrmd021,
         A.ztcrmc01,
         A.ztcrmc02,
         A.ztcrmc03,
         A.ztcrmc04,
         A.ztcrmc05,
         A.NETVALORD,
         A.CRM_TAXAMO,
         A.GRSVALORD,
         A.zamk0011,
         A.zamk0010,
         A.zcrmk006,
         A.zcrmk007,
         A.zcrmk009,
         A.CRM_SRVKB,
         A.zcrmk003,
         A.zcrmk004,
         A.zcrmk005,
         A.zyf_pay,
         A.zxy_pay,
         A.znpt_atm,
         A.CRM_NUMOFI,
         A.zamk0024,
         A.zcrmk008,
         A.SALES_UNIT,
         A.CURRENCY,
         A.CRM_CURREN,
         A.zcrmd031,
         A.zehrc012,
         A.zcrmd048,
         A.zcrmd086,
         A.zcrmd019,
         A.zthrc027,
         A.zthrc026,
         A.zthrc025,
         A.ztcrmc11,
         A.zcrmd199,
         A.ztlec001,
         A.zcondk001,
         A.zcrmd120,
         A.CHANGED_BY,
         A.zmater2,
         A.zztransf,
         A.ztmstamp
    FROM ODSHAPPIGO.V_ODS_ORDER A
   WHERE A.crmpostdat = 20180408;

--1.1
call od_order_etl.insert_ods_order(20180408);
select count(1) from odshappigo.ods_order a where a.crmpostdat = 20180408;
select count(1) from odshappigo.ods_order_yj a;

--2.ods_order_cancel
INSERT INTO ODSHAPPIGO.ODS_ORDER_CANCEL
  (CRM_OBJ_ID,
   CRM_NUMINT,
   RECORDMODE,
   ZEAMC008,
   CRM_OHGUID,
   CRM_ITMGUI,
   CRM_PRCTYP,
   ZCRMD023,
   CRM_ITMTYP,
   ZTCMC002,
   ZTCMC006,
   SALESORG,
   DISTR_CHAN,
   SALES_OFF,
   DIVISION,
   ZMATERIAL,
   ZEAMC027,
   ZLIFNR,
   CRM_ENDCST,
   ZTCMC016,
   AGE,
   ZTCMC020,
   CRM_SOLDTO,
   ZKUNNR_L1,
   ZKUNNR_L2,
   ZTHRC015,
   BP_EMPLO,
   ZTHRC016,
   ZTHRC017,
   ZESDC113,
   CRMPOSTDAT,
   ZPST_TIM,
   ZGZ_TIME,
   ZCRMD001,
   CRM_USSTAT,
   CRM_STSMA,
   CRM_CTD_BY,
   CRM_CRD_AT,
   CREA_TIME,
   ZEAMC001,
   ZEAMC010,
   ZEAMC011,
   ZEAMC012,
   ZEAMC037,
   ZEAMC013,
   ZEAMC014,
   ZTCMC021,
   ZTCMC022,
   ZTCMC027,
   ZTCMC026,
   ZTCMC030,
   ZTCMC007,
   ZTCMC008,
   ZTCMC009,
   ZTCMC023,
   ZTCMC024,
   ZTCMC025,
   ZCRMD015,
   ZCRMD016,
   ZCRMD017,
   ZCRMD018,
   ZCR_ON,
   ZOBJ_CC,
   ZDSXD,
   ZJSJF_YN,
   ZCRMD025,
   ZCRMD020,
   ZCRMD021,
   ZTCRMC01,
   ZTCRMC02,
   ZTCRMC03,
   ZTCRMC04,
   ZTCRMC05,
   UNIT,
   NETVALORD,
   CRM_TAXAMO,
   GRSVALORD,
   ZAMK0011,
   ZAMK0010,
   ZCRMK006,
   ZCRMK007,
   ZCRMK009,
   CRM_SRVKB,
   ZCRMK003,
   ZCRMK004,
   ZCRMK005,
   ZYF_PAY,
   ZXY_PAY,
   ZNPT_ATM,
   CRM_NUMOFI,
   ZAMK0024,
   ZCRMK008,
   SALES_UNIT,
   CURRENCY,
   CRM_CURREN,
   ZCRMD031,
   ZEHRC012,
   ZCRMD048,
   ZCRMD086,
   ZCRMD019,
   ZTHRC027,
   ZTCRMC11,
   ZTHRC026,
   ZTHRC025,
   ZTLEC001,
   ZCRMD120,
   ZMATER2,
   ZZTRANSF,
   ZCONDK001)
  SELECT A.CRM_OBJ_ID,
         A.CRM_NUMINT,
         A.RECORDMODE,
         A.ZEAMC008,
         A.CRM_OHGUID,
         A.CRM_ITMGUI,
         A.CRM_PRCTYP,
         A.ZCRMD023,
         A.CRM_ITMTYP,
         A.ZTCMC002,
         A.ZTCMC006,
         A.SALESORG,
         A.DISTR_CHAN,
         A.SALES_OFF,
         A.DIVISION,
         A.ZMATERIAL,
         A.ZEAMC027,
         A.ZLIFNR,
         A.CRM_ENDCST,
         A.ZTCMC016,
         A.AGE,
         A.ZTCMC020,
         A.CRM_SOLDTO,
         A.ZKUNNR_L1,
         A.ZKUNNR_L2,
         A.ZTHRC015,
         A.BP_EMPLO,
         A.ZTHRC016,
         A.ZTHRC017,
         A.ZESDC113,
         A.CRMPOSTDAT,
         A.ZPST_TIM,
         A.ZGZ_TIME,
         A.ZCRMD001,
         A.CRM_USSTAT,
         A.CRM_STSMA,
         A.CRM_CTD_BY,
         A.CRM_CRD_AT,
         A.CREA_TIME,
         A.ZEAMC001,
         A.ZEAMC010,
         A.ZEAMC011,
         A.ZEAMC012,
         A.ZEAMC037,
         A.ZEAMC013,
         A.ZEAMC014,
         A.ZTCMC021,
         A.ZTCMC022,
         A.ZTCMC027,
         A.ZTCMC026,
         A.ZTCMC030,
         A.ZTCMC007,
         A.ZTCMC008,
         A.ZTCMC009,
         A.ZTCMC023,
         A.ZTCMC024,
         A.ZTCMC025,
         A.ZCRMD015,
         A.ZCRMD016,
         A.ZCRMD017,
         A.ZCRMD018,
         A.ZCR_ON,
         A.ZOBJ_CC,
         A.ZDSXD,
         A.ZJSJF_YN,
         A.ZCRMD025,
         A.ZCRMD020,
         A.ZCRMD021,
         A.ZTCRMC01,
         A.ZTCRMC02,
         A.ZTCRMC03,
         A.ZTCRMC04,
         A.ZTCRMC05,
         A.UNIT,
         A.NETVALORD,
         A.CRM_TAXAMO,
         A.GRSVALORD,
         A.ZAMK0011,
         A.ZAMK0010,
         A.ZCRMK006,
         A.ZCRMK007,
         A.ZCRMK009,
         A.CRM_SRVKB,
         A.ZCRMK003,
         A.ZCRMK004,
         A.ZCRMK005,
         A.ZYF_PAY,
         A.ZXY_PAY,
         A.ZNPT_ATM,
         A.CRM_NUMOFI,
         A.ZAMK0024,
         A.ZCRMK008,
         A.SALES_UNIT,
         A.CURRENCY,
         A.CRM_CURREN,
         A.ZCRMD031,
         A.ZEHRC012,
         A.ZCRMD048,
         A.ZCRMD086,
         A.ZCRMD019,
         A.ZTHRC027,
         A.ZTHRC026,
         A.ZTHRC025,
         A.ZTCRMC11,
         A.ZTLEC001,
         A.ZCRMD120,
         A.ZMATER2,
         A.ZZTRANSF,
         A.ZCONDK001
    FROM ODSHAPPIGO.V_ODS_ORDER_CANCEL A
   WHERE A.CRMPOSTDAT = 20180408;

--2.1
create table odshappigo.ods_order_cancel_yj as
select * from odshappigo.ods_order_cancel a where a.crmpostdat=20180408;

delete odshappigo.ods_order_cancel a where a.crmpostdat=20180408;
select * from odshappigo.ods_order_cancel a where a.crmpostdat = 20180408;
call od_order_etl.INSERT_ODS_ORDER_CANCEL(20180408);

--3.
select * from odshappigo.ods_order a where a.crmpostdat=20180409 and a.crm_obj_id=5207706811;


--tmp
select * from odshappigo.ods_order_yj a where a.crm_obj_id = 5207694752;
select 13842 * 2 from dual;
select * from s_parameters2 for update;
select * from w_etl_log a order by a.start_time desc;

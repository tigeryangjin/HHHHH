--1.
CREATE TABLE FACT_EC_ORDER_STATE AS
SELECT A.ORDER_ID, A.ORDER_STATE FROM FACTEC_ORDER A WHERE 1 = 2;
--2.
UPDATE FACTEC_ORDER A
   SET A.ORDER_STATE =
       (SELECT B.ORDER_STATE
          FROM FACT_EC_ORDER_STATE B
         WHERE A.ORDER_ID = B.ORDER_ID)
 WHERE EXISTS (SELECT 1
          FROM FACT_EC_ORDER_STATE C
         WHERE A.ORDER_ID = C.ORDER_ID
           AND A.ORDER_STATE <> C.ORDER_STATE);


--3.





--96443
SELECT COUNT(1) FROM FACT_EC_ORDER_STATE A;
SELECT * FROM FACT_EC_ORDER_STATE A WHERE A.ORDER_STATE<>0;
SELECT * FROM FACTEC_ORDER;
SELECT * FROM FACT_EC_ORDER_2;
SELECT * FROM FACTEC_ORDER A WHERE A.ORDER_STATE IS NULL;



--1.
-- Create sequence 
create sequence MEMBER_LABEL_LINK_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

--2.
SELECT * FROM MEMBER_LABEL_LINK A WHERE A.ROW_ID IS NULL;
SELECT COUNT(1) FROM MEMBER_LABEL_LINK A WHERE A.ROW_ID IS NULL;
SELECT A.M_LABEL_ID, COUNT(1)
  FROM MEMBER_LABEL_LINK A
 WHERE A.ROW_ID IS NULL
 GROUP BY A.M_LABEL_ID
 ORDER BY 1;
SELECT * FROM MEMBER_LABEL_LINK A WHERE A.M_LABEL_ID=163;
SELECT * FROM MEMBER_LABEL_LINK A WHERE A.M_LABEL_ID IS NULL;
--3.
ALTER TABLE MEMBER_LABEL_LINK NOLOGGING;
ALTER SESSION ENABLE PARALLEL DML;
UPDATE /*+PARALLEL(4)*/ MEMBER_LABEL_LINK A
   SET A.ROW_ID           = MEMBER_LABEL_LINK_SEQ.NEXTVAL,
       A.LAST_UPDATE_DATE = SYSDATE
 WHERE A.ROW_ID IS NULL;
COMMIT;
ALTER SESSION DISABLE PARALLEL DML;
ALTER TABLE MEMBER_LABEL_LINK LOGGING;



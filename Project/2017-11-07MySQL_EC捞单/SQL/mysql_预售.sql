SELECT pre_id
FROM ec_pre_sale_order
WHERE add_time >= UNIX_TIMESTAMP('2018-01-21') AND add_time <= UNIX_TIMESTAMP('2018-01-24')
      AND order_state >= 20
      AND erp_code IN ('232201',
  '230584',
  '232203',
  '233404',
  '233093',
  '232836',
  '206311',
  '219733',
  '233534',
  '232363',
  '232856',
  '233008',
  '233020',
  '232706',
  '228320',
  '231848',
  '224288',
  '193006',
  '232854',
  '233527',
  '233024',
  '232359',
  '230799',
  '206848',
  '232733',
  '217799',
  '229509',
  '203244',
  '232740',
  '232736',
  '232834',
  '228594',
  '229517',
  '220803',
  '188922',
  '232418',
  '201995',
  '232357',
  '211450',
  '182685',
  '202360',
  '229510',
  '225299',
  '208504',
  '201875',
  '222851',
  '222859',
  '232839',
  '234069',
  '234065',
  '230536',
  '207104',
  '233032',
  '215950',
  '233410',
  '233411',
  '233412',
  '224002',
  '233738',
  '233735',
  '232741',
  '197770',
  '233620',
  '233617',
  '233618',
  '230870',
  '228973',
  '230692',
  '232490',
  '224347',
  '233756',
  '230689',
  '228970',
  '232611',
  '228964',
  '228976',
  '232578',
  '233363',
  '233362',
  '233568',
  '233565',
  '233571',
  '232370',
  '232796',
  '228971',
  '232373',
  '229463',
  '232800',
  '229465',
  '233274',
  '198671',
  '201822',
  '206591',
  '204190',
  '232284',
  '232288',
  '232429',
  '204336',
  '228030',
  '210905',
  '210903',
  '205438',
  '212420',
  '232393',
  '232279',
  '225693',
  '227762',
  '205437',
  '231902',
  '231904',
  '232542',
  '228349',
  '223273',
  '229094',
  '211796',
  '228097',
  '232431',
  '222260',
  '233014',
  '228581',
  '229447',
                       '232384',
                       '228523',
                       '228522',
                       '228530',
                       '230728',
                       '230729',
                       '230740',
                       '218629',
                       '228989')
GROUP BY pre_id;

#定金支付数
SELECT
  pre_id,
  erp_code,
  goods_name,
  count(1) AS '定金支付数'
FROM ec_pre_sale_order
WHERE add_time > UNIX_TIMESTAMP('2017-11-1')
      AND order_state >= 20
      AND erp_code IN ('229514',
  '208292',
  '211045',
  '225667',
  '190714',
  '204255',
  '228964',
  '228956',
  '228970',
  '228430',
  '228966',
  '228973',
  '228974',
  '228954',
  '228955',
  '228436',
  '228960',
  '228962',
  '203009',
  '222417',
  '222408',
  '228968',
  '228432',
  '223853',
  '228972',
  '201290',
  '228971',
  '228840',
  '228810',
  '229351',
  '229057',
  '228610',
  '229350',
  '229357',
  '228322',
  '229510',
  '223723',
  '229415',
  '229392',
  '229051',
  '228463',
  '220257',
  '215400',
  '227507',
  '229545',
  '226597001',
  '221265001',
  '212639001',
  '228003001',
  '220052003',
  '203862001',
  '229498',
  '229496',
  '229499',
  '229494',
  '229519',
  '229515',
  '229457',
  '229447',
  '228349001',
  '228876',
  '228320',
  '192587',
  '227751',
  '183718',
  '228520',
  '225666',
  '228436',
  '228840',
  '206855001',
  '207926001')
GROUP BY pre_id;

#查询预售
SELECT
  pre_id                    AS '活动ID',
  concat('`', pre_order_sn) AS '预售编号',
  order_id                  AS '关联尾款订单ID',
  concat('`', order_sn)     AS '关联尾款订单SN',
  buyer_id                  AS '顾客ID',
  cust_no                   AS '顾客编号',
  FROM_UNIXTIME(add_time)   AS '下单时间',
  pre_sale_price            AS '定金',
  #tail_price as '尾款',
  erp_code                     '商品编号',
  goods_name                AS '商品名称'
FROM ec_pre_sale_order
WHERE pre_id IN
      ('447',
        '448',
        '449',
        '450',
        '453',
        '454',
        '456',
        '459',
        '460',
        '461',
        '462',
        '464',
        '465',
        '467',
        '468',
        '471',
        '472',
        '474',
        '478',
        '479',
        '481',
        '494',
        '506',
        '512',
        '513',
        '527',
        '530',
        '548',
        '561',
        '567',
        '569',
       '570',
       '571')
      AND order_state = 20;

/*
ec_pre_sale_order 表 where order_state = 20,得到 order_id 不为空的，
通过 order_id 查询 ec_order where order_state >= 20 就是支付尾款
*/
#查询商品
SELECT
  a.order_id                AS '订单ID',
  concat('`', order_sn)     AS '订单编号',
  cust_no                   AS '顾客编号',
  member_level              AS '会员等级',
  goods_amount              AS '商品金额',
  order_amount              AS '订单金额',
  FROM_UNIXTIME(add_time)   AS '下单时间',
  concat('`', erp_order_no) AS 'homa编号',
  erp_code                  AS '商品编号',
  goods_name                AS '商品名称',
  goods_type
FROM
  ec_order a,
  ec_order_goods c
WHERE
  a.order_id = c.order_id
  AND a.order_state >= '20'
  AND add_time >= UNIX_TIMESTAMP('2018-01-25 00:00') AND add_time < UNIX_TIMESTAMP('2018-01-29 00:00')
  AND order_sn IN
      ('670570204656227445',
        '950570187848417648',
        '840570153707603634',
        '200570153667229634',
        '490570272611448219',
        '740570180866120748',
        '190570195778448578',
        '660570116046360539',
        '670570067821135634',
        '360570112289453199',
        '790570191891160238',
        '330570177950168891',
        '470570153729348634',
        '170570272561239219',
        '120570184286103629',
        '620570183521912291',
        '520570218204442891',
        '170570153982562471',
        '970570177874020891',
        '940570186870726495',
        '680570191335708615',
        '280570279230759184',
        '540570279199147184',
        '280570180502212010',
        '980570189305800535',
        '970570189285122535',
        '280570186521064695',
        '370570189155999332',
        '760570189123679332',
        '570570153913061471',
        '770570178951308074',
        '920570186566769852',
        '570570191795156747',
        '750570179571253951',
        '350570153777430682',
        '420570154880794405',
        '100570245396729005',
        '560570153693023682',
        '850570187431371670',
        '870570221118159090',
        '630570197041683578',
        '960570158879203737',
        '350570153690239244',
        '630570190453337828',
        '290570188509245637',
        '890570211704907781',
        '950570227194649059',
        '630570188583296637',
        '250570187119362157',
        '420570188543805637',
        '490570218198480199',
        '670570155704038578',
        '930570181414593833',
        '720570188781750240',
        '340570186512801234',
        '220570181279665833',
        '630570186606493703',
        '310570215501366755',
        '590570177076305043',
        '870570196798146243',
        '150570187965870390',
        '490570187940991390',
        '280570187890608390',
        '640570188923128222',
        '170570153733009628',
        '170570181359152307',
        '650570167446519058',
        '240570181262324307',
        '760570160657486828',
        '820570160612929828',
        '110570176231442784',
        '650570193053459282',
        '820570193554720118',
        '260570167786067629',
        '800570153701939375',
        '750570232942782425',
        '270570187744413390',
        '310570181650837812',
        '930570186626338695',
        '160570154087325411',
        '100570181173038664',
       '850570205798103228',
       '720570189234645535',
       '820570225352737411',
       '670570178988058997',
       '900570187231573286',
       '200570187428326962',
       '220570266700700235',
       '390570289538094912',
       '370570215545646755')


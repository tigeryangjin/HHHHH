#渠道、券号、适用商品、领取次数、使用次数、领取到使用的间隔时长
SELECT
  A.voucher_t_id            券号,
  A.voucher_add_application 领取渠道,
  COUNT(1)                  领取数
FROM ec_voucher A
WHERE A.voucher_t_id IN (4786,
  4790,
  4791,
  4792,
  4793,
  4794,
  4795,
  4796,
  4797,
  4798,
  4799,
  4800,
  4801,
  4802,
  4803,
  4804,
  4805,
  4806,
  4807,
  4808,
  4809,
  4810,
  4811,
  4812,
  4813,
  4814,
  4815,
  4816,
  4817,
  4818,
  4819,
  4820,
  4821,
  4822,
  4823,
  4824,
  4825,
  4826,
  4827,
  4828,
  4829,
                         4830,
                         4831,
                         4832,
                         4833,
                         4834,
                         4835)
GROUP BY A.voucher_t_id;

#券号，使用渠道，使用数
SELECT
  b.voucher_ref 券号,
  a.app_name    使用渠道,
  count(1)      使用数
FROM happigo_ec.ec_order a, happigo_ec.ec_order_common b
WHERE a.order_id = b.order_id
      AND a.order_state >= '20' AND add_time >= UNIX_TIMESTAMP('2017-12-23 00:00:00') AND
      add_time <= UNIX_TIMESTAMP('2017-12-26 00:00')
      AND b.voucher_ref IN
          ('4786',
            '4790',
            '4791',
            '4792',
            '4793',
            '4794',
            '4795',
            '4796',
            '4797',
            '4798',
            '4799',
            '4800',
            '4801',
            '4802',
            '4803',
            '4804',
            '4805',
            '4806',
            '4807',
            '4808',
            '4809',
            '4810',
            '4811',
            '4812',
            '4813',
            '4814',
            '4815',
            '4816',
            '4817',
            '4818',
            '4819',
            '4820',
            '4821',
            '4822',
            '4823',
            '4824',
            '4825',
            '4826',
            '4827',
            '4828',
            '4829',
           '4830',
           '4831',
           '4832',
           '4833',
           '4834',
           '4835')
GROUP BY b.voucher_ref,
  a.app_name;


/*优惠券商品级捞单SQL*/
#订单状态：0(已取消)10(默认):未付款;20:已付款;30:已发货;40:已收货（妥投）;50:已确认收货;
SELECT
  voucher_ref                 AS '券号',
  voucher_name                AS '券名称',
  voucher_price               AS '券名称',
  cust_no                     AS '顾客编号',
  member_level                AS '会员等级',
  a.app_name                  AS '下单渠道',
  a.order_state               AS '订单状态',
  CONCAT('`', order_sn)       AS '订单编号',
  CONCAT('`', a.erp_order_no) AS 'ERP订单编号',
  goods_amount                AS '商品金额',
  order_amount                AS '订单金额',
  FROM_UNIXTIME(add_time)     AS '下单时间',
  erp_code                    AS '商品编号',
  goods_name                  AS '商品名称',
  goods_num                   AS '商品数量'
FROM happigo_ec.ec_order a, happigo_ec.ec_order_common b, happigo_ec.ec_order_goods c
WHERE a.order_id = b.order_id AND b.order_id = c.order_id AND a.order_id = c.order_id
      AND add_time >= UNIX_TIMESTAMP('2017-12-23 00:00:00') AND
      add_time <= UNIX_TIMESTAMP('2017-12-26 00:00')
      AND b.voucher_ref IN
          ('4786',
            '4790',
            '4791',
            '4792',
            '4793',
            '4794',
            '4795',
            '4796',
            '4797',
            '4798',
            '4799',
            '4800',
            '4801',
            '4802',
            '4803',
            '4804',
            '4805',
            '4806',
            '4807',
            '4808',
            '4809',
            '4810',
            '4811',
            '4812',
            '4813',
            '4814',
            '4815',
            '4816',
            '4817',
            '4818',
            '4819',
            '4820',
            '4821',
            '4822',
            '4823',
            '4824',
            '4825',
            '4826',
            '4827',
            '4828',
            '4829',
           '4830',
           '4831',
           '4832',
           '4833',
           '4834',
           '4835'
          )
ORDER BY voucher_ref, a.order_id;


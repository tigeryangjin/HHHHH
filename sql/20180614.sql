--1.分日期
SELECT A.CRMPOSTDAT, COUNT(1)
  FROM ODSHAPPIGO.SAP_BIC_AZTCRD00100 A
 WHERE NOT EXISTS (SELECT 1
          FROM ODSHAPPIGO.ODS_ORDER B
         WHERE B.CRM_ITMGUI = A.CRM_ITMGUI)
 GROUP BY A.CRMPOSTDAT
 ORDER BY A.CRMPOSTDAT DESC;

--2.
SELECT *
  FROM ODSHAPPIGO.SAP_BIC_AZTCRD00100 A
 WHERE NOT EXISTS (SELECT 1
          FROM ODSHAPPIGO.ODS_ORDER B
         WHERE B.CRM_ITMGUI = A.CRM_ITMGUI)
 ORDER BY A.CRMPOSTDAT, A.CRM_OHGUID;

--3.
SELECT * FROM ODSHAPPIGO.OD_ORDER_ITEM A WHERE A.ORDER_NO=20180613765042;
SELECT * FROM ODSHAPPIGO.SAP_BIC_AZTCRD00100 A WHERE A.CRM_OHGUID=20180613765042;
SELECT * FROM ODSHAPPIGO.ODS_ORDER A WHERE A.CRM_OHGUID=20180613765042;

--4.订购数据在退货的时候才一起进来
SELECT * FROM ODSHAPPIGO.OD_ORDER_ITEM A WHERE A.ORDER_NO=20171113276388;
SELECT * FROM ODSHAPPIGO.SAP_BIC_AZTCRD00100 A WHERE A.CRM_OHGUID=20171113276388;
SELECT * FROM ODSHAPPIGO.ODS_ORDER A WHERE A.CRM_OHGUID=20171113276388;

--5.
SELECT * FROM ODSHAPPIGO.OD_ORDER_ITEM A WHERE A.ORDER_NO=20180223605864;
SELECT * FROM ODSHAPPIGO.SAP_BIC_AZTCRD00100 A WHERE A.CRM_OHGUID=20180223605864;
SELECT * FROM ODSHAPPIGO.ODS_ORDER A WHERE A.CRM_OHGUID=20180223605864;

--6.唯一键确认
SELECT A.CRM_ITMGUI, COUNT(1)
  FROM ODSHAPPIGO.SAP_BIC_AZTCRD00100 A
 GROUP BY A.CRM_ITMGUI
HAVING COUNT(1) > 1;

--7.数据量对比
SELECT COUNT(1) FROM ODSHAPPIGO.SAP_BIC_AZTCRD00100 A WHERE A.CRMPOSTDAT=20180614;

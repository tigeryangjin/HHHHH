/*
7月1日-11月22日   浏览过家装类商品的用户
*/
--浏览
SELECT TO_NUMBER(A.MEMBER_KEY) MEMBER_BP, COUNT(1) ITEM_CNT
  FROM FACT_PAGE_VIEW PARTITION(FPV2018) A
 WHERE A.VISIT_DATE_KEY BETWEEN 20180701 AND 20181122
   AND A.MEMBER_KEY <> 0
   AND A.APPLICATION_KEY IN (10, 20)
   AND a.page_value =
       translate(a.page_value,
                 '0' || translate(a.page_value, '#0123456789', '#'),
                 '0')
   AND EXISTS (SELECT 1
          FROM (SELECT D.GOODS_COMMONID
                  FROM DIM_EC_GOOD D, DIM_GOOD_CLASS E
                 WHERE D.MATKL = E.MATKL
								 AND E.MATDL=46) B
         WHERE A.PAGE_VALUE = B.GOODS_COMMONID)
 GROUP BY TO_NUMBER(A.MEMBER_KEY)
 ORDER BY COUNT(1) DESC;

--TMP
SELECT * FROM DIM_GOOD A WHERE A.GOODS_NAME LIKE '%直邮%';
select * from FACT_PAGE_VIEW t WHERE T.VISIT_DATE_KEY >= 20181101;
select DISTINCT T.APPLICATION_KEY, T.APPLICATION_NAME
  from FACT_PAGE_VIEW SUBPARTITION(FPV201811) t
 WHERE T.VISIT_DATE_KEY >= 20181115;
SELECT * FROM DIM_EC_GOOD A WHERE A.GOODS_NAME LIKE '%马未都%';
SELECT * FROM DIM_EC_GOOD A WHERE A.GOODS_NAME LIKE '%刺猬紫檀%';
SELECT * FROM DIM_GOOD_CLASS A WHERE A.MATDLT LIKE '%家装%';
SELECT * FROM DIM_GOOD_CLASS A WHERE A.MATZLT LIKE '%家装%';
SELECT * FROM DIM_GOOD_CLASS A WHERE A.MATXLT LIKE '%家装%';
SELECT * FROM DIM_GOOD_CLASS A WHERE A.Matklt LIKE '%家装%';

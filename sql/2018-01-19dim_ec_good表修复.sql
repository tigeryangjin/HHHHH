--如果MATDLT,MATZLT,MATXLT,MATKLT为空，则更新 yangjin 2018-01-19
--MATDL
UPDATE DIM_EC_GOOD A
   SET A.MATDLT =
       (SELECT MAX(B.MATDLT) MATDLT
          FROM DIM_GOOD_CLASS B
         WHERE A.MATDL = B.MATDL)
 WHERE A.MATDLT IS NULL
   AND A.MATDL > 0
   AND EXISTS
 (SELECT 1 FROM DIM_GOOD_CLASS C WHERE A.MATDL = C.MATDL);
COMMIT;

--MATZL
UPDATE DIM_EC_GOOD A
   SET A.MATZLT =
       (SELECT MAX(B.MATZLT) MATZLT
          FROM DIM_GOOD_CLASS B
         WHERE A.MATZL = B.MATZL)
 WHERE A.MATZLT IS NULL
   AND A.MATZL > 0
   AND EXISTS
 (SELECT 1 FROM DIM_GOOD_CLASS C WHERE A.MATZL = C.MATZL);
COMMIT;

--MATXL
UPDATE DIM_EC_GOOD A
   SET A.MATXLT =
       (SELECT MAX(B.MATXLT) MATXLT
          FROM DIM_GOOD_CLASS B
         WHERE A.MATXL = B.MATXL)
 WHERE A.MATXLT IS NULL
   AND A.MATXL > 0
   AND EXISTS
 (SELECT 1 FROM DIM_GOOD_CLASS C WHERE A.MATXL = C.MATXL);
COMMIT;

--MATKL
UPDATE DIM_EC_GOOD A
   SET A.MATKLT =
       (SELECT MAX(B.MATKLT) MATKLT
          FROM DIM_GOOD_CLASS B
         WHERE A.MATKL = B.MATKL)
 WHERE A.MATKLT IS NULL
   AND A.MATKL > 0
   AND EXISTS
 (SELECT 1 FROM DIM_GOOD_CLASS C WHERE A.MATKL = C.MATKL);
COMMIT;

SELECT * FROM DIM_EC_GOOD A WHERE A.MATDLT IS NULL;
SELECT * FROM DIM_EC_GOOD A WHERE A.ITEM_CODE=1110070;
SELECT * FROM DIM_GOOD A WHERE A.ITEM_CODE=1110070;

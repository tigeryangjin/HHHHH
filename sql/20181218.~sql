SELECT * FROM DIM_PAGE A ORDER BY A.PAGE_KEY DESC;

SELECT A.PAGE_NAME, A.APPLICATION_KEY, A.APPLICATION_NAME, COUNT(1)
  FROM DIM_PAGE A
 GROUP BY A.PAGE_NAME, A.APPLICATION_KEY, A.APPLICATION_NAME
 ORDER BY COUNT(1) DESC;

SELECT *
  FROM DIM_PAGE A
 WHERE A.PAGE_NAME = 'Good_Details_Broad'
   AND A.APPLICATION_NAME = 'KLGmgTV'
 ORDER BY A.PAGE_KEY DESC;

SELECT * FROM DIM_APPLICATION;

DELETE DIM_PAGE A
 WHERE A.PAGE_NAME = 'Good_Details_Broad'
   AND A.APPLICATION_KEY IS NULL
   AND A.APPLICATION_NAME = 'KLGmgTV';

SELECT * FROM DIM_PAGE A ORDER BY A.PAGE_KEY;

SELECT * FROM DIM_PAGE A WHERE A.PAGE_KEY = 7781;

--1.
SELECT A.PAGE_NAME, COUNT(1)
  FROM DIM_PAGE A
 GROUP BY A.PAGE_NAME
 ORDER BY COUNT(1) DESC;

SELECT *
  FROM DIM_PAGE A
 WHERE A.PAGE_NAME = 'HappigoSign'
 ORDER BY A.PAGE_KEY DESC;

SELECT *
  FROM ALL_SOURCE A
 WHERE UPPER(A.TEXT) LIKE '%UPDATE%FACT_PAGE_VIEW%';
SELECT * FROM ALL_SOURCE A WHERE UPPER(A.TEXT) LIKE '%DIM_PAGE%';

--PROCESSPVAPPLICATION
--processpvpage

SELECT *
  FROM W_ETL_LOG A
 WHERE A.PROC_NAME = 'processpvpage'
--AND A.ETL_RECORD_INS > 0
 ORDER BY A.START_TIME DESC;

SELECT *
  FROM W_ETL_LOG A
 WHERE A.PROC_NAME = 'SP_SBI_W_PAGE_D'
--AND A.ETL_RECORD_INS > 0
 ORDER BY A.START_TIME DESC;

SELECT * FROM DIM_PAGE A ORDER BY A.PAGE_KEY DESC;

select distinct a.page_name,
                a.application_key,
                a.application_name,
                sysdate as insert_date
  from fact_page_view a
 where a.id between 1390963600 and 1390968091
   and not exists
 (select *
          from dim_page b
         where b.page_name = a.page_name
           and b.application_key = a.application_key);

SELECT *
  FROM FACT_PAGE_VIEW A
 WHERE A.PAGE_NAME = 'HappigoSign'
   AND A.APPLICATION_KEY IS NULL
   AND A.VISIT_DATE_KEY = 20181218;

SELECT *
  FROM FACT_PAGE_VIEW A
 WHERE A.APPLICATION_KEY IS NULL
   AND A.VISIT_DATE_KEY >= 20181201;

SELECT *
  FROM FACT_PAGE_VIEW A
 WHERE A.APPLICATION_NAME = 'wxlite_maill'
   AND A.VISIT_DATE_KEY = 20181218;

SELECT * FROM DIM_APPLICATION;

SELECT *
  FROM ALL_SOURCE A
 WHERE UPPER(A.TEXT) LIKE '%INSERT%DIM_APPLICATION%';

SELECT *
  FROM W_ETL_LOG A
 WHERE A.PROC_NAME = 'SP_SBI_W_APPLICATION_D'
 ORDER BY A.START_TIME DESC;

SELECT * FROM DIM_APPLICATION FOR UPDATE;

BIHAPPIGO.SP_SBI_W_APPLICATION_D;

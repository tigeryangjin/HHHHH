SELECT A.ORDER_KEY,
       A.GOODS_COMMON_KEY,
       A.SALES_SOURCE_SECOND_DESC,
       A.ORDER_DATE_KEY,
       A.ORDER_STATE,
       A.NUMS,
       A.ORDER_AMOUNT,
       A.CANCEL_STATE,
       A.CANCEL_DATE_KEY,
       A.UPDATE_TIME
  FROM FACT_GOODS_SALES A
 WHERE A.POSTING_DATE_KEY = 20180308
   AND A.ORDER_STATE = 0;
	 
SELECT *
  FROM W_ETL_LOG A
 WHERE A.PROC_NAME = 'createordergoods'
 ORDER BY A.START_TIME DESC;
SELECT *
  FROM W_ETL_LOG A
 WHERE A.PROC_NAME = 'YANGJIN_PKG.OPER_PRODUCT_DAILY_RPT'
 ORDER BY A.START_TIME DESC;
SELECT A.CRMPOSTDAT, COUNT(1)
  FROM ODSHAPPIGO.ODS_ORDER A
 GROUP BY A.CRMPOSTDAT
 ORDER BY A.CRMPOSTDAT;
SELECT *
  FROM ODSHAPPIGO.ODS_ORDER A
 WHERE A.CRM_OBJ_ID IN (5207314168, 5207314149);
SELECT A.ORDER_KEY,
       A.GOODS_COMMON_KEY,
       A.SALES_SOURCE_SECOND_DESC,
       A.ORDER_DATE_KEY,
       A.ORDER_STATE,
       A.NUMS,
       A.ORDER_AMOUNT,
       A.CANCEL_STATE,
       A.CANCEL_DATE_KEY,
       A.UPDATE_TIME
  FROM FACT_GOODS_SALES A
 WHERE A.SALES_SOURCE_SECOND_KEY = '20017'
   AND A.POSTING_DATE_KEY = 20180316
   AND A.GOODS_COMMON_KEY = 235272;
SELECT A.ORDER_KEY,
       A.GOODS_COMMON_KEY,
       A.SALES_SOURCE_SECOND_DESC,
       A.ORDER_DATE_KEY,
       A.ORDER_STATE,
       A.NUMS,
       A.ORDER_AMOUNT,
       A.CANCEL_STATE,
       A.CANCEL_DATE_KEY,
       A.UPDATE_TIME
  FROM FACT_GOODS_SALES A
 WHERE A.SALES_SOURCE_SECOND_KEY = '20017'
   AND A.UPDATE_TIME = 20180316
   AND A.GOODS_COMMON_KEY = 235272;
SELECT *
  FROM FACT_GOODS_SALES_REVERSE A
 WHERE A.SALES_SOURCE_SECOND_KEY = '20017'
   AND A.POSTING_DATE_KEY = 20180316
   AND A.GOODS_COMMON_KEY = 235272;
SELECT *
  FROM FACT_GOODS_SALES_REVERSE A
 WHERE A.SALES_SOURCE_SECOND_KEY = '20017'
   AND A.UPDATE_TIME = 20180316
   AND A.GOODS_COMMON_KEY = 235272;
SELECT *
  FROM OPER_PRODUCT_DAILY_REPORT A
 WHERE A.POSTING_DATE_KEY = 20180316
   AND A.SALES_SOURCE_SECOND_NAME = '新媒体APP（2.0）'
   AND A.ITEM_CODE = 235272
 ORDER BY A.Item_Code;

SELECT A.Item_Code, SUM(A.EFFECTIVE_ORDER_AMOUNT) EFFECTIVE_ORDER_AMOUNT
  FROM OPER_PRODUCT_DAILY_REPORT A
 WHERE A.POSTING_DATE_KEY = 20180316
   AND A.SALES_SOURCE_SECOND_NAME = '新媒体APP（2.0）'
   AND A.ITEM_CODE = 235272
 GROUP BY A.Item_Code
 ORDER BY A.Item_Code;

SELECT A.Item_Code, SUM(A.EFFECTIVE_ORDER_AMOUNT) EFFECTIVE_ORDER_AMOUNT
  FROM OPER_PRODUCT_DAILY_REPORT A
 WHERE A.POSTING_DATE_KEY = 20180316
   AND A.SALES_SOURCE_SECOND_NAME = '新媒体APP（2.0）'
 GROUP BY A.Item_Code
 ORDER BY A.Item_Code;

SELECT *
  FROM ODSHAPPIGO.ODS_ORDER A
 WHERE A.CRMPOSTDAT = 20180315
   AND A.CRM_CRD_AT <> A.CRMPOSTDAT;

SELECT A.POSTING_DATE_KEY,
       SUM(A.EFFECTIVE_ORDER_AMOUNT) EFFECTIVE_ORDER_AMOUNT
  FROM OPER_PRODUCT_DAILY_REPORT A
 WHERE A.POSTING_DATE_KEY BETWEEN 20180301 AND 20180331
   AND A.SALES_SOURCE_SECOND_NAME = '新媒体APP（2.0）'
 GROUP BY A.POSTING_DATE_KEY
 ORDER BY A.POSTING_DATE_KEY;

SELECT A.CRMPOSTDAT, COUNT(1)
  FROM ODSHAPPIGO.ODS_ORDER A
 GROUP BY A.CRMPOSTDAT
 ORDER BY A.CRMPOSTDAT;

SELECT *
  FROM OPER_PRODUCT_DAILY_REPORT A
 WHERE A.POSTING_DATE_KEY = 20180331
   AND A.ITEM_CODE = 217670
   AND A.SALES_SOURCE_SECOND_NAME = '新媒体APP（2.0）';
SELECT *
  FROM FACT_GOODS_SALES A
 WHERE A.POSTING_DATE_KEY = 20180331
   AND A.GOODS_COMMON_KEY = 217670
   AND A.SALES_SOURCE_SECOND_KEY = 20017
   AND A.ORDER_STATE = 1;
SELECT *
  FROM FACT_GOODS_SALES A
 WHERE A.UPDATE_TIME = 20180331
   AND A.GOODS_COMMON_KEY = 217670
   AND A.SALES_SOURCE_SECOND_KEY = 20017
   AND A.CANCEL_STATE = 1
   AND A.CANCEL_BEFORE_STATE = 1;
FROM FACT_GOODS_SALES ODU2 WHERE ODU2.CANCEL_STATE = 1 AND ODU2.CANCEL_BEFORE_STATE = 1;

SELECT A.CRMPOSTDAT, COUNT(1)
  FROM ODSHAPPIGO.ODS_ORDER A
 GROUP BY A.CRMPOSTDAT
 ORDER BY A.CRMPOSTDAT DESC;

SELECT A.MEMBER_KEY, SUM(A.NUMS)
  FROM FACT_GOODS_SALES A
 WHERE A.POSTING_DATE_KEY = 20180401
   AND A.GOODS_COMMON_KEY = 232786
--AND A.ORDER_STATE = 1
 GROUP BY A.MEMBER_KEY;

SELECT *
  FROM W_ETL_LOG T
 WHERE TRUNC(T.START_TIME) >= TRUNC(SYSDATE) - 3
   AND (T.ETL_STATUS <> 'SUCCESS' OR T.ETL_STATUS IS NULL)
 ORDER BY T.START_TIME DESC;

SELECT * FROM ODSHAPPIGO.ODS_ORDER A WHERE A.CRMPOSTDAT = 20180401;

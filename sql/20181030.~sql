BEGIN
  DBMS_STATS.GATHER_TABLE_STATS(OWNNAME => 'DW_USER',
                                TABNAME => 'FACT_PAGE_VIEW',
                                DEGREE  => 4,
                                CASCADE => TRUE);
END;
/

SELECT B.OWNER "owner",
       B.TABLE_NAME "table_naeme",
       ROUND(A.SEG_BYTES / 1024 / 1024, 1) "SEG_BYTES(MB)",
       ROUND(B.TAB_BYTES / 1024 / 1024, 1) "TAB_BYTES(MB)",
       ROUND((A.SEG_BYTES - B.TAB_BYTES) / 1024 / 1024, 1) "free(MB)",
       ROUND(B.TAB_BYTES / A.SEG_BYTES, 2) "used_per",
       B.LAST_ANALYZED
  FROM (SELECT A1.OWNER, A1.SEGMENT_NAME, SUM(A1.BYTES) SEG_BYTES
          FROM DBA_SEGMENTS A1
         GROUP BY OWNER, SEGMENT_NAME) A,
       (SELECT B1.OWNER,
               B1.TABLE_NAME,
               B1.LAST_ANALYZED,
               SUM(B1.NUM_ROWS * B1.AVG_ROW_LEN) TAB_BYTES
          FROM DBA_TABLES B1
         GROUP BY OWNER, TABLE_NAME, B1.LAST_ANALYZED) B
 WHERE A.SEGMENT_NAME = B.TABLE_NAME
   AND B.OWNER IN ('DW_USER', 'ODSHAPPIGO')
 ORDER BY 5 DESC;
 
SELECT * FROM DBA_SEGMENTS A WHERE A.segment_name='FACT_PAGE_VIEW_DAILY';
SELECT * FROM DBA_TABLES A WHERE A.TABLE_NAME='FACT_PAGE_VIEW_DAILY';

SELECT * FROM FACT_PAGE_VIEW_DAILY;

--1.
SELECT A.owner,
       A.segment_name,
       A.segment_type,
       SUM(A.BYTES) / 1024 / 1024 BYTES_MB
  FROM DBA_SEGMENTS A
 GROUP BY A.owner, A.segment_name, A.segment_type
 ORDER BY SUM(A.BYTES) / 1024 / 1024 DESC;

--2.FACT_GOODS_SALES
/*
blocks:4076349
*/
--2.1.
ALTER TABLE DW_USER.FACT_GOODS_SALES MOVE PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_EC_ORDER REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_CANCEL_DATE REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_ORDER_TYPE REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_TRAN_TYPE REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_SALES_SOURCE_SECOND REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_SALES_SOURCE REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_POSTING_KEY REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_ORDER_KEY REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_ORDER_H_KEY REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_ORDER_DATE_KEY REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_UPDATE_TIME REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_ORDER_G REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_GOODS_COMMONID REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_GOODS_ID REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_LIVE_ORDER REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX DW_USER.GS_ORDER_TYPE NOPARALLEL;
ALTER INDEX DW_USER.GS_CANCEL_DATE NOPARALLEL;
ALTER INDEX DW_USER.GS_SALES_SOURCE_SECOND NOPARALLEL;
ALTER INDEX DW_USER.GS_SALES_SOURCE NOPARALLEL;
ALTER INDEX DW_USER.GS_POSTING_KEY NOPARALLEL;
ALTER INDEX DW_USER.GS_ORDER_KEY NOPARALLEL;
ALTER INDEX DW_USER.GS_ORDER_H_KEY NOPARALLEL;
ALTER INDEX DW_USER.GS_ORDER_DATE_KEY NOPARALLEL;
ALTER INDEX DW_USER.GS_UPDATE_TIME NOPARALLEL;
ALTER INDEX DW_USER.GS_ORDER_G NOPARALLEL;
ALTER INDEX DW_USER.GS_GOODS_COMMONID NOPARALLEL;
ALTER INDEX DW_USER.GS_GOODS_ID NOPARALLEL;
ALTER INDEX DW_USER.GS_LIVE_ORDER NOPARALLEL;
ALTER INDEX DW_USER.GS_EC_ORDER NOPARALLEL;
ALTER INDEX DW_USER.GS_TRAN_TYPE NOPARALLEL;

--2.2.
BEGIN
  DBMS_STATS.GATHER_TABLE_STATS(OWNNAME => 'DW_USER',
                                TABNAME => 'STATS_ONLINE_GOOD2_MINUTE',
                                DEGREE  => 4,
                                CASCADE => TRUE);
END;
/

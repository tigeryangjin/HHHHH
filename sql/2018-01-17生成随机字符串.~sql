/*
1、10元现金券（200000份）（满99使用）1张
2、第二名（1份）：韩国进口惠人原汁机1台
3、第三名（3份）：120元无门槛券1张
4、第四名（10份）：60元无门槛券1张
5、第五名（8份）：定制雨伞1把
6、第六名（15份）：定制可爱公仔1只
7、第六名（50份）：20元无门槛券1张
8、纪念奖（1000份）：50元现金券（满199使用）1张;
*/
DECLARE
  IN_COUNT     NUMBER(8);
  IN_CHAR      NUMBER(2);
  IN_JUAN_NAME VARCHAR2(60);
  IN_QUANTITY  NUMBER;
  CHARS_STR    VARCHAR2(100);
  RETURN_STR   VARCHAR2(100);
  IS_EXISTS    NUMBER(1);
BEGIN
  IN_JUAN_NAME := '50元现金券'; /*券名称*/
  IN_QUANTITY  := 1000; /*生成券数量*/
  IN_COUNT     := 0;
  IN_CHAR      := 0;
  CHARS_STR    := 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
  WHILE IN_COUNT < IN_QUANTITY LOOP
    RETURN_STR := '';
    FOR IN_CHAR IN 1 .. 8 LOOP
      RETURN_STR := RETURN_STR ||
                    SUBSTR(CHARS_STR, TRUNC(DBMS_RANDOM.VALUE(1, 32)), 1);
    END LOOP;
    IN_COUNT := IN_COUNT + 1;
    SELECT COUNT(1)
      INTO IS_EXISTS
      FROM YANGJIN_JUAN A
     WHERE A.JUAN_NO = RETURN_STR;
    IF IS_EXISTS = 0
    THEN
      INSERT INTO YANGJIN_JUAN
        (JUAN_NO, JUAN_NAME)
      VALUES
        (RETURN_STR, IN_JUAN_NAME);
      COMMIT;
    END IF;
  END LOOP;
END;
/

  SELECT A.JUAN_NAME, A.JUAN_NO
    FROM YANGJIN_JUAN A
   ORDER BY A.JUAN_NAME, A.JUAN_NO;

SELECT A.JUAN_NAME, COUNT(1) FROM YANGJIN_JUAN A GROUP BY A.JUAN_NAME;

DELETE YANGJIN_JUAN A WHERE A.JUAN_NAME='10元现金券';
COMMIT;

TRUNCATE TABLE YANGJIN_JUAN;

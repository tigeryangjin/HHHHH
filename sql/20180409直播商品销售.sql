--1. 
select b.erp_code,
       sum(b.goods_num) order_qty,
       sum(b.goods_pay_price * b.goods_num) order_amount
  from fact_ec_order_2 a, fact_ec_order_goods b
 where a.order_id = b.order_id
      --and a.add_time between trunc(sysdate) - 366 and trunc(sysdate) - 1
   and a.order_state >= 20
   and b.erp_code in (188801,
                      201700,
                      205200,
                      207896,
                      211135,
                      212864,
                      213315,
                      213362,
                      213931,
                      214465,
                      214964,
                      214965,
                      215595,
                      216988,
                      217670,
                      218177,
                      218822,
                      218853,
                      219335,
                      220389,
                      220401,
                      220591,
                      220705,
                      220901,
                      220907,
                      222137,
                      222434,
                      222435,
                      222511,
                      222788,
                      222792,
                      223654,
                      224089,
                      224106,
                      224129,
                      224252,
                      224366,
                      224978,
                      225052,
                      225053,
                      225081,
                      225146,
                      225469,
                      225641,
                      226016,
                      227500,
                      227575,
                      227697,
                      227715,
                      227952,
                      228021,
                      228046,
                      228075,
                      228078,
                      228083,
                      228085,
                      228087,
                      228088,
                      228089,
                      228090,
                      228091,
                      228092,
                      228093,
                      228094,
                      228095,
                      228110,
                      228179,
                      228262,
                      228311,
                      228571,
                      228837,
                      228860,
                      228899,
                      228950,
                      229001,
                      229004,
                      229064,
                      229087,
                      229359,
                      229401,
                      230357,
                      230490,
                      230668,
                      230669,
                      230687,
                      230771,
                      230836,
                      231653,
                      231846,
                      232196,
                      232217,
                      232310,
                      232389,
                      232391,
                      232392,
                      232413,
                      232415,
                      232625,
                      232878,
                      232897,
                      232918,
                      232920,
                      232923,
                      232934,
                      232982,
                      232984,
                      233082,
                      233095,
                      233097,
                      233200,
                      233220,
                      233379,
                      233380,
                      233383,
                      233427,
                      233428,
                      233545,
                      233556,
                      233590,
                      233591,
                      233592,
                      233658,
                      233690,
                      233724,
                      233806,
                      233809,
                      233832,
                      233833,
                      233834,
                      233836,
                      234047,
                      234188,
                      234213,
                      234217,
                      234218,
                      234253,
                      234258,
                      234259,
                      234268,
                      234275,
                      234280,
                      234304,
                      234309,
                      234320,
                      234321,
                      234322,
                      234323,
                      234324,
                      234360,
                      234546,
                      234588,
                      234622,
                      234628,
                      234638,
                      234653,
                      234712,
                      234790,
                      234791,
                      234792,
                      234808,
                      234809,
                      234816,
                      234821,
                      234835,
                      234964,
                      234996,
                      235018,
                      235022,
                      235023,
                      235027,
                      235028,
                      235030,
                      235066,
                      235071,
                      235072,
                      235077,
                      235087,
                      235094,
                      235095,
                      235110,
                      235224,
                      235251,
                      235260,
                      235312,
                      235323,
                      235324,
                      235325,
                      235326,
                      235327,
                      235330,
                      235331,
                      235332,
                      235370,
                      235451,
                      235531,
                      235532,
                      235533,
                      235534,
                      235535,
                      235536,
                      235537,
                      235543,
                      235574,
                      235603,
                      235609,
                      236006,
                      236008,
                      236052,
                      236053,
                      236071,
                      236268,
                      236296,
                      236424)
 group by b.erp_code;

--2.
select a.goods_common_key item_code,
       sum(a.nums) order_qty,
       sum(a.order_amount) order_amount
  from fact_goods_sales a
 where a.order_state = 1
   /*and a.posting_date_key between to_char(trunc(sysdate) - 366, 'yyyymmdd') and
       to_char(trunc(sysdate) - 1, 'yyyymmdd')*/
   and a.goods_common_key in (188801,
                              201700,
                              205200,
                              207896,
                              211135,
                              212864,
                              213315,
                              213362,
                              213931,
                              214465,
                              214964,
                              214965,
                              215595,
                              216988,
                              217670,
                              218177,
                              218822,
                              218853,
                              219335,
                              220389,
                              220401,
                              220591,
                              220705,
                              220901,
                              220907,
                              222137,
                              222434,
                              222435,
                              222511,
                              222788,
                              222792,
                              223654,
                              224089,
                              224106,
                              224129,
                              224252,
                              224366,
                              224978,
                              225052,
                              225053,
                              225081,
                              225146,
                              225469,
                              225641,
                              226016,
                              227500,
                              227575,
                              227697,
                              227715,
                              227952,
                              228021,
                              228046,
                              228075,
                              228078,
                              228083,
                              228085,
                              228087,
                              228088,
                              228089,
                              228090,
                              228091,
                              228092,
                              228093,
                              228094,
                              228095,
                              228110,
                              228179,
                              228262,
                              228311,
                              228571,
                              228837,
                              228860,
                              228899,
                              228950,
                              229001,
                              229004,
                              229064,
                              229087,
                              229359,
                              229401,
                              230357,
                              230490,
                              230668,
                              230669,
                              230687,
                              230771,
                              230836,
                              231653,
                              231846,
                              232196,
                              232217,
                              232310,
                              232389,
                              232391,
                              232392,
                              232413,
                              232415,
                              232625,
                              232878,
                              232897,
                              232918,
                              232920,
                              232923,
                              232934,
                              232982,
                              232984,
                              233082,
                              233095,
                              233097,
                              233200,
                              233220,
                              233379,
                              233380,
                              233383,
                              233427,
                              233428,
                              233545,
                              233556,
                              233590,
                              233591,
                              233592,
                              233658,
                              233690,
                              233724,
                              233806,
                              233809,
                              233832,
                              233833,
                              233834,
                              233836,
                              234047,
                              234188,
                              234213,
                              234217,
                              234218,
                              234253,
                              234258,
                              234259,
                              234268,
                              234275,
                              234280,
                              234304,
                              234309,
                              234320,
                              234321,
                              234322,
                              234323,
                              234324,
                              234360,
                              234546,
                              234588,
                              234622,
                              234628,
                              234638,
                              234653,
                              234712,
                              234790,
                              234791,
                              234792,
                              234808,
                              234809,
                              234816,
                              234821,
                              234835,
                              234964,
                              234996,
                              235018,
                              235022,
                              235023,
                              235027,
                              235028,
                              235030,
                              235066,
                              235071,
                              235072,
                              235077,
                              235087,
                              235094,
                              235095,
                              235110,
                              235224,
                              235251,
                              235260,
                              235312,
                              235323,
                              235324,
                              235325,
                              235326,
                              235327,
                              235330,
                              235331,
                              235332,
                              235370,
                              235451,
                              235531,
                              235532,
                              235533,
                              235534,
                              235535,
                              235536,
                              235537,
                              235543,
                              235574,
                              235603,
                              235609,
                              236006,
                              236008,
                              236052,
                              236053,
                              236071,
                              236268,
                              236296,
                              236424)
 group by a.goods_common_key;

--1.
SELECT A.owner,
       A.segment_name,
       A.partition_name,
       A.segment_type,
       A.segment_subtype,
       A.tablespace_name,
       A.header_file,
       A.header_block,
       A.BYTES / 1024 / 1024 / 1024 SIZE_GB,
       A.blocks,
       A.extents,
       A.initial_extent,
       A.next_extent,
       A.min_extents,
       A.max_extents,
       A.max_size,
       A.retention,
       A.minretention,
       A.pct_increase,
       A.freelists,
       A.freelist_groups,
       A.relative_fno,
       A.BUFFER_POOL,
       A.flash_cache,
       A.cell_flash_cache
  FROM DBA_SEGMENTS A
 WHERE A.tablespace_name = 'EXDATA'--DB_LOGISTICS
 ORDER BY A.BYTES DESC;

--2.
SELECT B.COL1, B.OWNER, B.TABLE_NAME, B.COL2
  FROM (SELECT 1 COL1,
                A.owner,
                A.TABLE_NAME,
                'ALTER TABLE ' || A.OWNER || '.' || A.TABLE_NAME ||
                ' MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;' COL2
           FROM DBA_TABLES A
          WHERE /*A.tablespace_name = 'BDUDATA00'
            AND*/ A.PARTITIONED = 'NO'
         UNION ALL
         SELECT 2 COL1,
                A.owner,
                A.TABLE_NAME,
                'ALTER INDEX ' || A.OWNER || '.' || A.index_name ||
                ' REBUILD PARALLEL(DEGREE 4) NOLOGGING;' COL2
           FROM DBA_INDEXES A
          WHERE /*A.tablespace_name = 'BDUDATA00'                                                                                                                                                             AND*/
          A.partitioned = 'NO'
       AND A.INDEX_TYPE = 'NORMAL'
         UNION ALL
         SELECT 3 COL1,
                A.owner,
                A.TABLE_NAME,
                'ALTER INDEX ' || A.OWNER || '.' || A.index_name ||
                ' NOPARALLEL;' COL2
           FROM DBA_INDEXES A
          WHERE /*A.tablespace_name = 'BDUDATA00'
                                                                                                                                                                             AND*/
          A.partitioned = 'NO'
       AND A.INDEX_TYPE = 'NORMAL') B
 WHERE B.TABLE_NAME = 'TMP_0620'
 ORDER BY B.OWNER, B.TABLE_NAME, B.COL1; 
 
--3.
--MSEG
ALTER TABLE ODSHAPPIGO.MSEG MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--LIPS
ALTER TABLE ODSHAPPIGO.LIPS MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX ODSHAPPIGO.PK_LIPS REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX ODSHAPPIGO.PK_LIPS NOPARALLEL;

--ZMKOL_H
ALTER TABLE ODSHAPPIGO.ZMKOL_H MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--LIKP
ALTER TABLE ODSHAPPIGO.LIKP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX ODSHAPPIGO.PK_LIKP REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX ODSHAPPIGO.PK_LIKP NOPARALLEL;

--NEW_KONP_TEMP
ALTER TABLE ODSHAPPIGO.NEW_KONP_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--NEW_KONP
ALTER TABLE ODSHAPPIGO.NEW_KONP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--ZTSCM012
ALTER TABLE ODSHAPPIGO.ZTSCM012 MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX ODSHAPPIGO.PK_ZTSCM012 REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX ODSHAPPIGO.PK_ZTSCM012 NOPARALLEL;

--NEW_A903
ALTER TABLE ODSHAPPIGO.NEW_A903 MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--NEW_A903_TEMP
ALTER TABLE ODSHAPPIGO.NEW_A903_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--NEW_ZTMM023
ALTER TABLE ODSHAPPIGO.NEW_ZTMM023 MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--NEW_ZTMM023_TEMP
ALTER TABLE ODSHAPPIGO.NEW_ZTMM023_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--ZMCHB_H
ALTER TABLE ODSHAPPIGO.ZMCHB_H MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--LIPS_TEMP
ALTER TABLE ODSHAPPIGO.LIPS_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--MSEG_TEMP
ALTER TABLE ODSHAPPIGO.MSEG_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--LIKP_TEMP
ALTER TABLE ODSHAPPIGO.LIKP_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--ZMKOL_H_TEMP
ALTER TABLE ODSHAPPIGO.ZMKOL_H_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--ZTSCM012_TEMP
ALTER TABLE ODSHAPPIGO.ZTSCM012_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--ZMCHB_H_TEMP
ALTER TABLE ODSHAPPIGO.ZMCHB_H_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--ODS_BUYER
ALTER TABLE ODSHAPPIGO.ODS_BUYER MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--TMP_0620
ALTER TABLE ODSHAPPIGO.TMP_0620 MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--4.************************************************************************************************
--MSEG
ALTER TABLE ODSHAPPIGO.MSEG MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--LIPS
ALTER TABLE ODSHAPPIGO.LIPS MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX ODSHAPPIGO.PK_LIPS REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX ODSHAPPIGO.PK_LIPS NOPARALLEL;

--ZMKOL_H
ALTER TABLE ODSHAPPIGO.ZMKOL_H MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--LIKP
ALTER TABLE ODSHAPPIGO.LIKP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX ODSHAPPIGO.PK_LIKP REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX ODSHAPPIGO.PK_LIKP NOPARALLEL;

--NEW_KONP_TEMP
ALTER TABLE ODSHAPPIGO.NEW_KONP_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--NEW_KONP
ALTER TABLE ODSHAPPIGO.NEW_KONP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--ZTSCM012
ALTER TABLE ODSHAPPIGO.ZTSCM012 MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX ODSHAPPIGO.PK_ZTSCM012 REBUILD PARALLEL(DEGREE 4) NOLOGGING;
ALTER INDEX ODSHAPPIGO.PK_ZTSCM012 NOPARALLEL;

--NEW_A903
ALTER TABLE ODSHAPPIGO.NEW_A903 MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--NEW_A903_TEMP
ALTER TABLE ODSHAPPIGO.NEW_A903_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--NEW_ZTMM023
ALTER TABLE ODSHAPPIGO.NEW_ZTMM023 MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--NEW_ZTMM023_TEMP
ALTER TABLE ODSHAPPIGO.NEW_ZTMM023_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--ZMCHB_H
ALTER TABLE ODSHAPPIGO.ZMCHB_H MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--LIPS_TEMP
ALTER TABLE ODSHAPPIGO.LIPS_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--MSEG_TEMP
ALTER TABLE ODSHAPPIGO.MSEG_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--LIKP_TEMP
ALTER TABLE ODSHAPPIGO.LIKP_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--ZMKOL_H_TEMP
ALTER TABLE ODSHAPPIGO.ZMKOL_H_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--ZTSCM012_TEMP
ALTER TABLE ODSHAPPIGO.ZTSCM012_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--ZMCHB_H_TEMP
ALTER TABLE ODSHAPPIGO.ZMCHB_H_TEMP MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--ODS_BUYER
ALTER TABLE ODSHAPPIGO.ODS_BUYER MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;

--TMP_0620
ALTER TABLE ODSHAPPIGO.TMP_0620 MOVE TABLESPACE EXDATA PARALLEL(DEGREE 4) NOLOGGING;






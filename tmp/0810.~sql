DECLARE
  --按rowid排序的cursor
  --删除条件是oo=xx，这个需根据实际情况来定
  CURSOR mycursor IS
    SELECT /*+ parallel(sls_ld_tmp_tmp 4)*/
     rowid
      FROM sls_ld_tmp_tmp
     WHERE sale_date < date '2017-03-01'
     ORDER BY rowid;
  TYPE rowid_table_type IS TABLE OF rowid index by pls_integer;
  v_rowid rowid_table_type;
BEGIN
  OPEN mycursor;
  LOOP
    FETCH mycursor BULK COLLECT
      INTO v_rowid LIMIT 5000; --5000行提交一次
    EXIT WHEN v_rowid.count = 0;
    FORALL i IN v_rowid.FIRST .. v_rowid.LAST
      DELETE /*+ parallel(sls_ld_tmp_tmp 4)*/
      sls_ld_tmp_tmp
       WHERE rowid = v_rowid(i);
    COMMIT;
  END LOOP;
  CLOSE mycursor;
END;
